var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,d,c){a instanceof String&&(a=String(a));for(var b=a.length,g=0;g<b;g++){var m=a[g];if(d.call(c,m,g,a))return{i:g,v:m}}return{i:-1,v:void 0}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,c){a!=Array.prototype&&a!=Object.prototype&&(a[d]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,d,c,b){if(d){c=$jscomp.global;a=a.split(".");for(b=0;b<a.length-1;b++){var g=a[b];g in c||(c[g]={});c=c[g]}a=a[a.length-1];b=c[a];d=d(b);d!=b&&null!=d&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:d})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6","es3");function csrfSafeMethod(a){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(a)}
$.ajaxSetup({beforeSend:function(a,d){csrfSafeMethod(d.type)||this.crossDomain||(d=getCookie("csrftoken"),a.setRequestHeader("X-CSRFToken",d))}});function toLines(a,d){a=a.split("\n");for(var c=0,b=null,g=null,m=0;m<length(a);m++){null===b&&c+length(a[m])>=d.start&&(b={line:m,pos:d.start-c});if(c+length(a[m])>=d.end){g={line:m,pos:d.end-c};break}c=c+length(a[m])+1}return{lines:a,selection:{start:b,end:g}}}function length(a){return a.length}
(function(a,d,c,b){a.fn.MarkdownEditor=function(){var d=function(a,c){var d=a.value;a=c;-1<d.indexOf("\r\n")&&(c=d.replace(/\r\n/g,"\n").slice(0,c).match(/\n/g),a+=c?c.length:0);return a},c={bold:{start:"**",end:"**",placeholder:"Your bold text",line:!1,block:!1},strike:{start:"~~",end:"~~",placeholder:"Your struckthrough text",line:!1,block:!1},italic:{start:"*",end:"*",placeholder:"Your emphasized text",line:!1,block:!1},head:{start:"#",end:"",placeholder:"Your header",line:!0,block:!1},quote:{start:"> ",
end:"",placeholder:"Your quote",line:!0,block:!1},link:{start:"[",end:"](https://example.org/)",placeholder:"Add your link text",line:!1,block:!1},image:{start:"![",end:"](https://example.org/)",placeholder:"Add image description",line:!1,block:!1},code:{start:"`",end:"`",placeholder:"Add inline code here",line:!1,block:!1},pre:{start:"    ",end:"",placeholder:"Block Code",line:!0,block:!0},ul:{start:"* ",end:"",placeholder:"List Item",line:!0,block:!0},ol:{start:"1. ",end:"",placeholder:"List Item",
line:!0,block:!0}};return this.each(function(){var b=this,g=!0,m=a(this).data("endpoint")||"/api/md_preview/",k=a('<div class="controls" id="'+b.id+'-controls" />');a(b).before(k.append('<div class="btn-toolbar" role="toolbar" aria-label="Markdown Toolbar"><div class="btn-group mr-2 mb-1" role="group" aria-label="Formatting"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Bold" class="btn btn-light c-bold"><i class="fas fa-bold"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Italic" class="btn btn-light c-italic"><i class="fas fa-italic"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Strikethrough" class="btn btn-light c-strike"><i class="fas fa-strikethrough"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Code" class="btn btn-light c-code"><i class="fas fa-code"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Heading" class="btn btn-light c-head"><i class="fas fa-heading"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Quote" class="btn btn-light c-quote"><i class="fas fa-quote-right"></i></button></div><div class="btn-group mr-2 mb-1" role="group" aria-label="Utilities"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Link" class="btn btn-light c-link"><i class="fas fa-link"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Image" class="btn btn-light c-image"><i class="fas fa-image"></i></button></div><div class="btn-group mr-2 mb-1" role="group" aria-label="Lists"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Bullet List" class="btn btn-light c-ul"><i class="fas fa-list-ul"></i></button><button type="button" data-toggle="tooltip" data-placement="bottom" title="Ordered List" class="btn btn-light c-ol"><i class="fas fa-list-ol"></i></button></div><div class="btn-group mr-2 mb-1" role="group" aria-label="Preview"><button type="button" data-toggle="tooltip" data-placement="bottom" title="Preview" class="btn btn-light c-preview"><i class="fas fa-eye"></i></button></div></div><div class="preview"></div>'));
k.find(".preview").slideUp();a(b).on("keydown",function(a){k.find(".card").addClass("text-muted");k.find(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye");g=!0;return MarkdownHelper(b,a)});a("button",k).on("click",function(a){a.preventDefault();b.focus();var f=this.className.substr(16);a={start:b.selectionStart,end:b.selectionEnd};var h=c[f];if("preview"===f)return g?(g=!1,k.find(".fa-eye").removeClass("fa-eye").addClass("fa-eye-slash"),createPreview(b,k,m)):(k.find(".preview").slideUp(),
k.find(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye"),g=!0),!0;var l=toLines(b.value,a);f=l.lines;var e=l.selection;h===c.code&&e.start.line!==e.end.line&&(h=c.pre);var n=0;l=0;if(h.line)if(e.start.line===e.end.line&&""===f[e.start.line])f[e.start.line]=h.start+h.placeholder+h.end,l+=length(f[e.start.line]);else{n+=length(h.start);for(var p=e.start.line;p<=e.end.line;p++)f[p]=h.start+f[p]+h.end,l+=length(h.start)}else a.start!==a.end?(f[e.end.line]=f[e.end.line].substring(0,e.end.pos)+
h.end+f[e.end.line].substring(e.end.pos),f[e.start.line]=f[e.start.line].substring(0,e.start.pos)+h.start+f[e.start.line].substring(e.start.pos),n+=length(h.start),l+=length(h.start)):(f[e.start.line]=f[e.start.line].substring(0,e.start.pos)+h.start+h.placeholder+h.end+f[e.start.line].substring(e.start.pos),n+=length(h.start),l+=length(h.start+h.placeholder));h.block&&0<=e.start.line-1&&""!==f[e.start.line-1]&&(f[e.start.line]="\n"+f[e.start.line],n+=1);h.block&&e.end.line+1<=f.length&&""!==f[e.end.line+
1]&&(f[e.end.line]+="\n");b.value=f.join("\n");h=a.start+n;a=a.end+l;b.focus();b.setSelectionRange?b.setSelectionRange(d(b,h),d(b,a)):b.createTextRange&&(f=b.createTextRange(),f.collapse(!0),f.moveEnd("character",a),f.moveStart("character",h),f.select());g=!0;k.find(".card").addClass("text-muted");k.find(".fa-eye-slash").removeClass("fa-eye-slash").addClass("fa-eye");return!0})})}})(jQuery,window,document);
function createPreview(a,d,c){$.post(c,{md:a.value},function(a,c,m){d.find(".preview").html(a).slideDown()})}
function MarkdownHelper(a,d){if(13===d.keyCode){var c=!1;d=a.value.replace(/\r\n/g,"\n");if(a.selectionStart)var b=a.selectionStart;else a.focus(),b=document.selection.createRange(),b.moveStart("character",-d.length),b=b.text.replace(/\r\n/g,"\n").length;var g=d.split("\n");var m=d.substr(0,b).split("\n").length;var n=g[m-1].replace(/^\s+/,"");var q=n.substr(0,2);if(/^[0-9]+[.] (.*)$/.test(n)){var l=n.substr(0,n.indexOf(". "));var k=l+". ";l=parseInt(l,10)+1+". ";c=!0}n&&!c&&"    "===g[m-1].substr(0,
4)&&(k=l="    ",c=!0);0<=["* ","+ ","- "].indexOf(q)&&(k=l=q,c=!0);if(c)return c=g[m-1].indexOf(k),n.replace(/^\s+/,"")===k?(a.value=d.substr(0,b-1-c-l.length)+"\n\n"+d.substr(b,d.length),k=b+1-l.length-c):(a.value=d.substr(0,b)+"\n"+Array(c+1).join(" ")+l+d.substr(b,d.length),k=b+1+l.length+c),a.selectionStart?a.setSelectionRange(k,k):(b=a.createTextRange(),b.move("character",k),b.select()),!1}}
function getCookie(a){var d=null;if(document.cookie&&""!==document.cookie)for(var c=document.cookie.split(";"),b=0;b<c.length;b++){var g=c[b].trim();if(g.substring(0,a.length+1)===a+"="){d=decodeURIComponent(g.substring(a.length+1));break}}return d};
